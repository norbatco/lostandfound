<!DOCTYPE html>
<html lang="en" ng-app="lostAndFoundApp">
<head>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NORBATCO Lost and Found</title>
  
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
  
  <!-- AngularJS -->
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>

  <!-- Icons -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">

  <!-- Styles -->
  <link rel="stylesheet" href="styles.css">

</head>
<body ng-controller="mainController">

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
    <a class="navbar-brand" href="#">
        <img src="https://raw.githubusercontent.com/norbatco/lostandfound/refs/heads/main/images.png" alt="NORBATCO Logo" style="height: 60px;">
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
      <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ml-auto">
              <li class="nav-item">
                  <a class="nav-link" href="#top" data-toggle="collapse" data-target="index.html">Home</a>
              </li>
              <li class="nav-item navbar-divider d-none d-lg-block">
                  <span>|</span>
              </li>
              <li class="nav-item">
                  <a class="nav-link" href="#" ng-click="toggleReportPopup()" data-toggle="collapse" data-target=".navbar-collapse.show">Create Report</a>
              </li>
              <li class="nav-item navbar-divider d-none d-lg-block">
                  <span>|</span>
              </li>
              <li class="nav-item">
                  <a class="nav-link" href="about.html">About</a>
              </li>
              <li class="nav-item navbar-divider d-none d-lg-block">
                  <span>|</span>
              </li>
              <li class="nav-item" ng-if="!adminMode">
                  <a class="nav-link" href="#" ng-click="toggleLoginPopup()" data-toggle="collapse" data-target=".navbar-collapse.show">Login</a>
              </li>
              <li class="nav-item" ng-if="adminMode">
                  <a class="nav-link text-danger" href="#" ng-click="logout()" data-toggle="collapse" data-target=".navbar-collapse.show">Logout</a>
              </li>
          </ul>
      </div>
  </nav>

  <!-- Header Section -->
  <div id="top" class="header fade-in">
    <br><br><br>
    <h1>NORBATCO Lost and Found</h1>
    <p>A Solution for Recovering Belongings on Public Transportation</p>
    <!-- Updated Button -->
    <button class="btn btn-primary my-2" ng-click="scrollDownByPercentage(30)">View Items</button>
  </div>

  <!-- Reported Items Section -->
<div class="container items-section">
  <h2 class="text-center">Reported Items</h2>

  <!-- Search Bar with Spyglass Icon -->
  <div class="form-group position-relative">
    <input type="text" class="form-control pl-4" ng-model="searchTerm" placeholder="Search for items..." />
    <i class="fas fa-search search-icon"></i>
  </div>

  <!-- Scrollable Box -->
      <div class="reported-items-container">
        <div class="row">
          <div class="col-md-4" ng-repeat="item in items | filter:searchTerm">
            <div class="card">
              <img ng-src="{{item.image}}" class="card-img-top" alt="{{item.itemName}}">
              <div class="card-body">
                <h5 class="card-title">{{item.itemName}}</h5>
                <p class="card-text">{{item.description}}</p>

                <!-- Editable Category Dropdown (Visible in Admin Mode) -->
                <div ng-if="adminMode">
                  <label for="category-{{$index}}">Category:</label>
                  <select id="category-{{$index}}" class="form-control" ng-model="item.category">
                    <option value="Lost">Lost</option>
                    <option value="Found">Found</option>
                    <option value="Not Found">Not Found</option>
                  </select>
                </div>
                <!-- Non-Editable Category -->
                <div ng-if="!adminMode">
                  <span class="category" ng-class="{
                    'category-found': item.category === 'Found',
                    'category-lost': item.category === 'Lost',
                    'category-notfound': item.category === 'Not Found'
                  }">{{item.category}}</span>
                </div>

                <!-- Delete Button (Visible in Admin Mode) -->
                <button ng-if="adminMode" class="btn btn-danger btn-sm mt-2" ng-click="deleteItem($index)">
                  Delete Report
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

  <!-- Report Form Section -->
    <div class="report-popup-container" ng-if="reportPopupVisible">
      <div class="report-popup-content">
          <form ng-submit="submitReport()">
              <h2 class="text-center">Create a Report</h2>
              <div class="form-group">
                  <label for="userName">Your Name</label>
                  <input type="text" class="form-control" id="userName" ng-model="newItem.name" placeholder="Enter your name" required />
              </div>
              <div class="form-group">
                  <label for="itemName">Item Name</label>
                  <input type="text" class="form-control" id="itemName" ng-model="newItem.itemName" placeholder="Enter item name" required />
              </div>
              <div class="form-group">
                  <label for="itemDescription">Item Description</label>
                  <textarea class="form-control" id="itemDescription" ng-model="newItem.description" rows="3" placeholder="Describe the item" required></textarea>
              </div>
              <div class="form-group">
                  <label for="itemCategory">Category</label>
                  <select class="form-control" id="itemCategory" ng-model="newItem.category" required>
                      <option value="Lost">Lost</option>
                      <option value="Found">Found</option>
                  </select>
              </div>
              <div class="form-group">
                  <label for="itemImage">Upload Item Image</label>
                  <input type="file" class="form-control-file" id="itemImage" 
                      ng-model="newItem.imageFile" 
                      onchange="angular.element(this).scope().handleFileUpload(this.files)" />
              </div>
              <button type="submit" class="btn btn-primary btn-block">Submit Report</button>

              <!-- New Close Button -->
              <button type="button" class="btn btn-secondary btn-block mt-1" ng-click="toggleReportPopup()">Close</button>
          </form>
      </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-container">
      <div class="footer-left">
        <p>101 New Kawayan, Tacloban City, Leyte</p>
        <p># 093 9379 33017</p>
        <p>norbatco@gmail.com</p>
      </div>
      <div class="footer-center">
        <p></p>
        <p></p>
        <br>
        <br>
        <p>&copy; NORBATCO Lost and Found</p>
      </div>
      <div class="footer-right">
        <p>Find us @:</p>
        <br>
        <a href="https://facebook.com" target="_blank" class="social-icon"><i class="fab fa-facebook"></i></a>
        <a href="https://instagram.com" target="_blank" class="social-icon"><i class="fab fa-instagram"></i></a>
        <a href="https://x.com" target="_blank" class="social-icon"><i class="fab fa-twitter"></i></a>
      </div>
    </div>
  </footer>

  <!-- Button to trigger login popup -->
  <button class="btn-show-login" ng-click="toggleLoginPopup()">Login</button>

  <!-- Login Popup -->
  <div class="popup-container" ng-if="loginVisible"> <!-- Use ng-if instead of ng-show -->
    <div class="popup-content">
      <form ng-submit="handleLogin()">
        <h2>Login</h2>
        <div class="form-group">
          <label for="email">Email</label>
          <div class="input-wrapper">
            <i class="fa fa-user"></i>
            <input type="email" id="email" ng-model="user.email" placeholder="Email Address" required />
          </div>
        </div>
        <div class="form-group">
          <label for="password">Password</label>
          <div class="input-wrapper">
            <i class="fa fa-lock"></i>
            <input type="password" id="password" ng-model="user.password" placeholder="Password" required />
            <span class="toggle-password" ng-click="togglePasswordVisibility()">
              <i class="fa" ng-class="passwordVisible ? 'fa-eye-slash' : 'fa-eye'"></i>
            </span>
          </div>
        </div>
        <button type="submit" class="btn-login">Login</button>
      </form>
    </div>
  </div>

  <!-- Javascript -->
  <script src="scripts.js"></script>

  <!-- Bootstrap and jQuery Scripts -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
